<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from discordjs.guide/voice/the-basics.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 17 Jan 2021 09:05:06 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>The Basics | Discord.js Guide</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="icon" href="../favicon.png">
    <meta name="description" content="A guide made by the community of discord.js for its users.">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#42b983">
    <meta name="twitter:card" content="summary">
    <meta name="og:title" content="Discord.js Guide">
    <meta name="og:description" content="A guide made by the community of discord.js for its users.">
    <meta name="og:type" content="website">
    <meta name="og:url" content="../index.html">
    <meta name="og:locale" content="en_US">
    <meta name="og:image" content="../meta-image.png">
    <link rel="preload" href="../assets/css/0.styles.c81fdb25.css" as="style"><link rel="preload" href="../assets/js/app.1b16820c.js" as="script"><link rel="preload" href="../assets/js/4.58143105.js" as="script"><link rel="preload" href="../assets/js/66.37172aa5.js" as="script"><link rel="preload" href="../assets/js/16.e90c1593.js" as="script"><link rel="preload" href="../assets/js/6.1ed8886a.js" as="script"><link rel="prefetch" href="../assets/js/1.4966f13b.js"><link rel="prefetch" href="../assets/js/10.d9e5e65a.js"><link rel="prefetch" href="../assets/js/11.4d024292.js"><link rel="prefetch" href="../assets/js/12.0ebfb6b5.js"><link rel="prefetch" href="../assets/js/13.ec6ebc85.js"><link rel="prefetch" href="../assets/js/14.e0c1c3e6.js"><link rel="prefetch" href="../assets/js/15.468032d7.js"><link rel="prefetch" href="../assets/js/17.48dc860b.js"><link rel="prefetch" href="../assets/js/18.66fb5b1b.js"><link rel="prefetch" href="../assets/js/19.267ae342.js"><link rel="prefetch" href="../assets/js/20.c083e492.js"><link rel="prefetch" href="../assets/js/21.c20bf682.js"><link rel="prefetch" href="../assets/js/22.549d06f2.js"><link rel="prefetch" href="../assets/js/23.97219136.js"><link rel="prefetch" href="../assets/js/24.597d3784.js"><link rel="prefetch" href="../assets/js/25.e66ea496.js"><link rel="prefetch" href="../assets/js/26.3e94b2e9.js"><link rel="prefetch" href="../assets/js/27.c1f13a28.js"><link rel="prefetch" href="../assets/js/28.7159a662.js"><link rel="prefetch" href="../assets/js/29.d4774ef2.js"><link rel="prefetch" href="../assets/js/30.90995d89.js"><link rel="prefetch" href="../assets/js/31.de2dcdf7.js"><link rel="prefetch" href="../assets/js/32.a19a8a69.js"><link rel="prefetch" href="../assets/js/33.d3547ea6.js"><link rel="prefetch" href="../assets/js/34.999b3eb5.js"><link rel="prefetch" href="../assets/js/35.8165c07f.js"><link rel="prefetch" href="../assets/js/36.2b277f69.js"><link rel="prefetch" href="../assets/js/37.3ea48fb0.js"><link rel="prefetch" href="../assets/js/38.c2159f22.js"><link rel="prefetch" href="../assets/js/39.50884a19.js"><link rel="prefetch" href="../assets/js/40.a8990f37.js"><link rel="prefetch" href="../assets/js/41.701c8a9b.js"><link rel="prefetch" href="../assets/js/42.b84d3fd9.js"><link rel="prefetch" href="../assets/js/43.5faf8a11.js"><link rel="prefetch" href="../assets/js/44.13615e3c.js"><link rel="prefetch" href="../assets/js/45.487383a0.js"><link rel="prefetch" href="../assets/js/46.9ed01b37.js"><link rel="prefetch" href="../assets/js/47.9f485986.js"><link rel="prefetch" href="../assets/js/48.8f87e54d.js"><link rel="prefetch" href="../assets/js/49.03b932fc.js"><link rel="prefetch" href="../assets/js/5.a0132f30.js"><link rel="prefetch" href="../assets/js/50.6ecc158d.js"><link rel="prefetch" href="../assets/js/51.ed256bb5.js"><link rel="prefetch" href="../assets/js/52.8aa55e0d.js"><link rel="prefetch" href="../assets/js/53.b92566e2.js"><link rel="prefetch" href="../assets/js/54.aa72db74.js"><link rel="prefetch" href="../assets/js/55.43db0b13.js"><link rel="prefetch" href="../assets/js/56.99a95047.js"><link rel="prefetch" href="../assets/js/57.36019a3d.js"><link rel="prefetch" href="../assets/js/58.bbb4a297.js"><link rel="prefetch" href="../assets/js/59.83d011b0.js"><link rel="prefetch" href="../assets/js/60.8138be15.js"><link rel="prefetch" href="../assets/js/61.f92820ad.js"><link rel="prefetch" href="../assets/js/62.ee2671f7.js"><link rel="prefetch" href="../assets/js/63.9ec4fce9.js"><link rel="prefetch" href="../assets/js/64.dde77080.js"><link rel="prefetch" href="../assets/js/65.c59bb07d.js"><link rel="prefetch" href="../assets/js/67.81b25533.js"><link rel="prefetch" href="../assets/js/68.af678c1d.js"><link rel="prefetch" href="../assets/js/7.97abf805.js"><link rel="prefetch" href="../assets/js/8.1ad597e1.js"><link rel="prefetch" href="../assets/js/9.d00e8d4e.js"><link rel="prefetch" href="../assets/js/vendors_docsearch.d31fbf91.js">
    <link rel="stylesheet" href="../assets/css/0.styles.c81fdb25.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="../index.html" class="home-link router-link-active"><!----> <span class="site-name">Discord.js Guide</span></a> <div class="links"><!----> <div class="user-settings"><a href="#" class="settings-button"><svg aria-hidden="true" data-prefix="fas" data-icon="cog" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="svg-inline--fa fa-cog fa-w-16 settings-icon"><path fill="currentColor" d="M444.788 291.1l42.616 24.599c4.867 2.809 7.126 8.618 5.459 13.985-11.07 35.642-29.97 67.842-54.689 94.586a12.016 12.016 0 0 1-14.832 2.254l-42.584-24.595a191.577 191.577 0 0 1-60.759 35.13v49.182a12.01 12.01 0 0 1-9.377 11.718c-34.956 7.85-72.499 8.256-109.219.007-5.49-1.233-9.403-6.096-9.403-11.723v-49.184a191.555 191.555 0 0 1-60.759-35.13l-42.584 24.595a12.016 12.016 0 0 1-14.832-2.254c-24.718-26.744-43.619-58.944-54.689-94.586-1.667-5.366.592-11.175 5.459-13.985L67.212 291.1a193.48 193.48 0 0 1 0-70.199l-42.616-24.599c-4.867-2.809-7.126-8.618-5.459-13.985 11.07-35.642 29.97-67.842 54.689-94.586a12.016 12.016 0 0 1 14.832-2.254l42.584 24.595a191.577 191.577 0 0 1 60.759-35.13V25.759a12.01 12.01 0 0 1 9.377-11.718c34.956-7.85 72.499-8.256 109.219-.007 5.49 1.233 9.403 6.096 9.403 11.723v49.184a191.555 191.555 0 0 1 60.759 35.13l42.584-24.595a12.016 12.016 0 0 1 14.832 2.254c24.718 26.744 43.619 58.944 54.689 94.586 1.667 5.366-.592 11.175-5.459 13.985L444.788 220.9a193.485 193.485 0 0 1 0 70.2zM336 256c0-44.112-35.888-80-80-80s-80 35.888-80 80 35.888 80 80 80 80-35.888 80-80z"></path></svg></a> <div class="user-settings-menu" style="display:none;"><div class="theme-options"><!----> <!----> <div class="dark-theme-options toggle-option"><label for="dark-theme-toggle">Enable Dark Theme?</label> <input id="dark-theme-toggle" type="checkbox"></div> <!----> <!----></div></div></div> <!----> <form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="../index.html" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="../commando/index.html" class="nav-link">
  Commando
</a></div><div class="nav-item"><a href="https://discord.js.org/#/docs/main/stable/general/welcome" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Discord.js Documentation
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/discordjs/guide" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="../index.html" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="../commando/index.html" class="nav-link">
  Commando
</a></div><div class="nav-item"><a href="https://discord.js.org/#/docs/main/stable/general/welcome" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Discord.js Documentation
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/discordjs/guide" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Home</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="../index.html" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="../requesting-more-content.html" class="sidebar-link">Requesting more content</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Installations &amp; Preparations</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="../preparations/index.html" class="sidebar-link">Installing Node.js and discord.js</a></li><li><a href="../preparations/setting-up-a-linter.html" class="sidebar-link">Setting up a linter</a></li><li><a href="../preparations/setting-up-a-bot-application.html" class="sidebar-link">Setting up a bot application</a></li><li><a href="../preparations/adding-your-bot-to-servers.html" class="sidebar-link">Adding your bot to servers</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Creating Your Bot</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="../creating-your-bot/index.html" class="sidebar-link">Getting your bot up &amp; running</a></li><li><a href="../creating-your-bot/configuration-files.html" class="sidebar-link">Configuration files</a></li><li><a href="../creating-your-bot/adding-more-commands.html" class="sidebar-link">Adding more commands</a></li><li><a href="../creating-your-bot/commands-with-user-input.html" class="sidebar-link">Commands with user input (a.k.a. &quot;arguments&quot;)</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Command Handler</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="../command-handling/index.html" class="sidebar-link">Command handling</a></li><li><a href="../command-handling/dynamic-commands.html" class="sidebar-link">Dynamic commands</a></li><li><a href="../command-handling/adding-features.html" class="sidebar-link">Additional features</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Popular Topics</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="../popular-topics/faq.html" class="sidebar-link">Frequently asked Questions</a></li><li><a href="../popular-topics/embeds.html" class="sidebar-link">Embeds</a></li><li><a href="../popular-topics/errors.html" class="sidebar-link">Errors</a></li><li><a href="../popular-topics/permissions.html" class="sidebar-link">Permissions</a></li><li><a href="../popular-topics/permissions-extended.html" class="sidebar-link">Permissions (extended)</a></li><li><a href="../popular-topics/reactions.html" class="sidebar-link">Reactions</a></li><li><a href="../popular-topics/collectors.html" class="sidebar-link">Collectors</a></li><li><a href="../popular-topics/partials.html" class="sidebar-link">Partial Structures</a></li><li><a href="../popular-topics/intents.html" class="sidebar-link">Gateway Intents</a></li><li><a href="../popular-topics/canvas.html" class="sidebar-link">Image manipulation with Canvas</a></li><li><a href="../popular-topics/webhooks.html" class="sidebar-link">Webhooks</a></li><li><a href="../popular-topics/audit-logs.html" class="sidebar-link">Working with Audit Logs</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Miscellaneous</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="../miscellaneous/parsing-mention-arguments.html" class="sidebar-link">Parsing mention arguments</a></li><li><a href="../miscellaneous/useful-packages.html" class="sidebar-link">Useful packages</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Databases</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="../sequelize/index.html" class="sidebar-link">Storing data with Sequelize</a></li><li><a href="../sequelize/currency.html" class="sidebar-link">Making a Currency System</a></li><li><a href="../keyv/index.html" class="sidebar-link">Storing data with Keyv</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Sharding</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="../sharding/index.html" class="sidebar-link">Getting started</a></li><li><a href="../sharding/additional-information.html" class="sidebar-link">Additional information</a></li><li><a href="../sharding/extended.html" class="sidebar-link">Extended changes</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>OAuth2</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="../oauth2/index.html" class="sidebar-link">Getting started with OAuth2</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Voice</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="index.html" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="understanding-voice.html" class="sidebar-link">Understanding Voice</a></li><li><a href="the-basics.html" aria-current="page" class="active sidebar-link">The Basics</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="the-basics.html#joining-voice-channels" class="sidebar-link">Joining voice channels</a></li><li class="sidebar-sub-header"><a href="the-basics.html#playing-audio" class="sidebar-link">Playing audio</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="the-basics.html#which-audio-sources-can-i-use" class="sidebar-link">Which audio sources can I use?</a></li></ul></li><li class="sidebar-sub-header"><a href="the-basics.html#controlling-the-stream-dispatcher" class="sidebar-link">Controlling the Stream Dispatcher</a></li><li class="sidebar-sub-header"><a href="the-basics.html#leaving-voice-channels" class="sidebar-link">Leaving voice channels</a></li></ul></li><li><a href="voice-broadcasts.html" class="sidebar-link">Voice Broadcasts</a></li><li><a href="optimisation-and-troubleshooting.html" class="sidebar-link">Optimization and Troubleshooting</a></li><li><a href="receiving-audio.html" class="sidebar-link">Receiving Audio</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Improving Your Dev Environment</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="../improving-dev-environment/pm2.html" class="sidebar-link">Managing your bot process with PM2</a></li><li><a href="../improving-dev-environment/package-json-scripts.html" class="sidebar-link">Setting up package.json scripts</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Additional Information</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="../additional-info/notation.html" class="sidebar-link">Understanding notation</a></li><li><a href="../additional-info/es6-syntax.html" class="sidebar-link">ES6 syntax examples</a></li><li><a href="../additional-info/collections.html" class="sidebar-link">Collections</a></li><li><a href="../additional-info/async-await.html" class="sidebar-link">Understanding async/await</a></li><li><a href="../additional-info/rest-api.html" class="sidebar-link">Using a REST API</a></li><li><a href="../additional-info/changes-in-v12.html" class="sidebar-link">Updating from v11 to v12</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="the-basics"><a href="#the-basics" class="header-anchor">#</a> The Basics</h1> <span style="display:none;"><p>The Discord.js voice system allows your bot to join voice channels and play audio. This guide will teach you how to make simple music bots, and tips and tricks to optimize performance!</p> <p>This voice guide is written for Discord.js v12, which features an improved audio system. Much of the example code in the voice guide is unsuitable for v11 and below - to access this content, please update Discord.js to v12!</p></span> <span style="display:block;"><p>Now that you have your dependencies installed, you can start using voice!</p> <h2 id="joining-voice-channels"><a href="#joining-voice-channels" class="header-anchor">#</a> Joining voice channels</h2> <p>Joining a voice channel is easy, here's a common example:</p> <div class="language-js extra-class"><pre class="language-js"><code>client<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">message</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token comment">// Join the same voice channel of the author of the message</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>message<span class="token punctuation">.</span>member<span class="token punctuation">.</span>voice<span class="token punctuation">.</span>channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token keyword">await</span> message<span class="token punctuation">.</span>member<span class="token punctuation">.</span>voice<span class="token punctuation">.</span>channel<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>If you try to join a channel the bot is already in, nothing will happen so we don't need to worry about running this method repeatedly.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>In the above example we accessed a <code>VoiceState</code> through <code>member.voice</code>. A voice state exists for members connected to a voice channel, and tells you which channel they're connected to, if the member is speaking, and whether they're deafened or muted. Consult the documentation for a full description of what voice states can do!</p></div> <h2 id="playing-audio"><a href="#playing-audio" class="header-anchor">#</a> Playing audio</h2> <p>Playing audio is also simple. A <code>StreamDispatcher</code> is created for you to control and monitor the playback of your audio over the voice channel.</p> <p>A VoiceConnection can only ever have at most one dispatcher. If you try to play another stream while audio is already playing, the existing stream will be destroyed and the new audio will begin to play shortly after.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Create a dispatcher</span>
<span class="token keyword">const</span> dispatcher <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token string">'audio.mp3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

dispatcher<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'start'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'audio.mp3 is now playing!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

dispatcher<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'finish'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'audio.mp3 has finished playing!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Always remember to handle errors appropriately!</span>
dispatcher<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> console<span class="token punctuation">.</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>To end the stream yourself, you can run:</p> <div class="language-js extra-class"><pre class="language-js"><code>dispatcher<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>You can also create the dispatcher with options. The following example will play a stream at 50% volume from the start on.</p> <div class="language-js extra-class"><pre class="language-js"><code>connection<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token string">'audio.mp3'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> volume<span class="token operator">:</span> <span class="token number">0.5</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="which-audio-sources-can-i-use"><a href="#which-audio-sources-can-i-use" class="header-anchor">#</a> Which audio sources can I use?</h3> <h4 id="ffmpeg"><a href="#ffmpeg" class="header-anchor">#</a> FFmpeg</h4> <p>In the example shown above, you can play a file from its path. This is an example of using FFmpeg to play a file. You can also pass a <code>ReadableStream</code> (or path) of most media files, e.g. mp3, mkv, mp4, and this will be played. You can even play from URLs!</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// From a path</span>
connection<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token string">'audio.mp3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// From a ReadableStream</span>
connection<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token string">'audio.mp3'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// From a URL</span>
connection<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token string">'http://myserver.com/audio.aac'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>You can consult the <a href="https://www.ffmpeg.org/ffmpeg-protocols.html#Protocols" target="_blank" rel="noopener noreferrer">FFmpeg Protocols<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> documentation for a full list of resources you can play with FFmpeg.</p> <h4 id="webm-ogg-opus-files"><a href="#webm-ogg-opus-files" class="header-anchor">#</a> WebM/Ogg Opus Files</h4> <p>WebM/Ogg Opus files already contain Opus audio, this means we do not require FFmpeg to convert the file. This is efficient, and using these files where possible will improve the performance of your bot.</p> <p>To play these files, you'll need to have a ReadableStream of the file and you'll need to specify the type of file when playing:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Play a WebM Opus stream</span>
connection<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token string">'audio.webm'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'webm/opus'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Play an Ogg Opus stream</span>
connection<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token string">'audio.ogg'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'ogg/opus'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>You may be wondering why we specified the source <code>type</code> in this example when we didn't in the FFmpeg one. Discord.js will default to the <code>'unknown'</code> (i.e. &quot;use FFmpeg&quot;) type when no type is provided.</p></div> <h2 id="controlling-the-stream-dispatcher"><a href="#controlling-the-stream-dispatcher" class="header-anchor">#</a> Controlling the Stream Dispatcher</h2> <p>You can pause, resume, and alter the volume of a stream dispatcher in real-time.</p> <div class="language-js extra-class"><pre class="language-js"><code>dispatcher<span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dispatcher<span class="token punctuation">.</span><span class="token function">resume</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Set the volume to 25%</span>
dispatcher<span class="token punctuation">.</span><span class="token function">setVolume</span><span class="token punctuation">(</span><span class="token number">0.25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>In cases where you'll be pausing/resuming a stream rapidly, you can use the <em>&quot;play silence&quot;</em> mode to prevent audio glitches occurring in the Discord client. To opt-in to this mode, simply pass <code>true</code> to the pause method:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Play silent packets while paused</span>
dispatcher<span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <h2 id="leaving-voice-channels"><a href="#leaving-voice-channels" class="header-anchor">#</a> Leaving voice channels</h2> <p>Leaving a voice channel will cause the current dispatcher (if there is one) to be destroyed, and will also destroy the voice connection.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Option 1</span>
connection<span class="token punctuation">.</span><span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Option 2</span>
voiceChannel<span class="token punctuation">.</span><span class="token function">leave</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></span></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/discordjs/guide/edit/master/guide/voice/the-basics.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">3/30/2020, 11:11:00 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="understanding-voice.html" class="prev">
        Understanding Voice
      </a></span> <span class="next"><a href="voice-broadcasts.html">
        Voice Broadcasts
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="../assets/js/app.1b16820c.js" defer></script><script src="../assets/js/4.58143105.js" defer></script><script src="../assets/js/66.37172aa5.js" defer></script><script src="../assets/js/16.e90c1593.js" defer></script><script src="../assets/js/6.1ed8886a.js" defer></script>
  </body>

<!-- Mirrored from discordjs.guide/voice/the-basics.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 17 Jan 2021 09:05:06 GMT -->
</html>
