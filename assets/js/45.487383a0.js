(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{478:function(t,a,s){"use strict";s.r(a);var e=s(5),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"managing-your-bot-process-with-pm2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#managing-your-bot-process-with-pm2"}},[t._v("#")]),t._v(" Managing your bot process with PM2")]),t._v(" "),s("p",[t._v('PM2 is a process manager. It manages your applications\' states, so you can start, stop, restart and delete processes. It offers features such as monitoring running processes and setting up a "start with operating system" (be that Windows, Linux or Mac) so your processes start when you boot your system.')]),t._v(" "),s("h2",{attrs:{id:"installation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#installation"}},[t._v("#")]),t._v(" Installation")]),t._v(" "),s("p",[t._v("You can install PM2 via npm:")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" --global pm2\n")])])]),s("p",[t._v("Or, if you use Yarn:")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" global "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" pm2\n")])])]),s("h2",{attrs:{id:"starting-your-app"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#starting-your-app"}},[t._v("#")]),t._v(" Starting your app")]),t._v(" "),s("p",[t._v("After PM2 has been installed, the easiest way you can start your app is by going to the directory your bot is in, and then run the following:")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("pm2 start your-app-name.js\n")])])]),s("h3",{attrs:{id:"additional-notes"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#additional-notes"}},[t._v("#")]),t._v(" Additional notes")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("pm2 start")]),t._v(" script allows for more optional command-line arguments.")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("--name")]),t._v(": This allows you to set the name of your process when listing it up with "),s("code",[t._v("pm2 list")]),t._v(" or "),s("code",[t._v("pm2 monit")]),t._v(":")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("pm2 start your-app-name.js --name "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Some cool name"')]),t._v("\n")])])]),s("ul",[s("li",[s("code",[t._v("--watch")]),t._v(": This option will automatically restart your process as soon as a file change has been detected, which can be useful for development environments:")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("pm2 start your-app-name.js --watch\n")])])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("pm2 start")]),t._v(" command can take more optional parameters, but for now only these 2 are relevant for us. If you want to see all the parameters available, you can check the documentation of pm2 "),s("a",{attrs:{href:"https://pm2.io/doc/en/runtime/reference/pm2-cli/",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),s("OutboundLink")],1),t._v(".")])]),t._v(" "),s("p",[t._v("Once the process is launched with pm2, you can run "),s("code",[t._v("pm2 monit")]),t._v(" to monitor any and all console outputs from the processes started by pm2. This accounts for any "),s("code",[t._v("console.log()")]),t._v(" in your code or outputted errors.")]),t._v(" "),s("h2",{attrs:{id:"setting-up-booting-with-your-system"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#setting-up-booting-with-your-system"}},[t._v("#")]),t._v(" Setting up booting with your system")]),t._v(" "),s("p",[t._v("Perhaps one of the more useful features of PM2 is being able to boot up with your Operating System. This will ensure that your bot processes will always be started after an (unexpected) reboot (e.g. after a power outage).")]),t._v(" "),s("p",[t._v("The initial steps to run differ per OS. In this guide, we'll cover those for Windows and for Linux/MacOS.")]),t._v(" "),s("h3",{attrs:{id:"initial-steps-for-windows"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#initial-steps-for-windows"}},[t._v("#")]),t._v(" Initial steps for Windows")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("Run these from an administrative command prompt to avoid getting hit with a bunch of UAC dialogs.")])]),t._v(" "),s("p",[s("strong",[t._v("Install the "),s("a",{attrs:{href:"https://www.npmjs.com/package/pm2-windows-service",target:"_blank",rel:"noopener noreferrer"}},[t._v("pm2-windows-service"),s("OutboundLink")],1),t._v(" package from npm:")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" --global pm2-windows-service\n")])])]),s("p",[s("strong",[t._v("After installation has finished, install the service by running the following command:")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("pm2-service-install\n")])])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("You can use the "),s("code",[t._v("-n")]),t._v(" parameter to set the service name: "),s("code",[t._v('pm2-service-install -n "the-service-name"')])])]),t._v(" "),s("h3",{attrs:{id:"initial-steps-for-linux-macos"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#initial-steps-for-linux-macos"}},[t._v("#")]),t._v(" Initial steps for Linux/MacOS")]),t._v(" "),s("p",[t._v("You need to get a start script, which you can get by running the following command:")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Detects the available init system, generates the config and enables startup system")]),t._v("\npm2 startup\n")])])]),s("p",[t._v("Or, if you want to manually specify your machine select one of the options with the command:")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("pm2 startup "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("ubuntu "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ubuntu14 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ubuntu12 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" centos "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" centos6 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" arch "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" oracle "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" amazon "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" macos "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" darwin "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" freesd "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" systemd "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" systemv "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" upstart "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" launchd "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" rcd "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" openrc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),s("p",[t._v("The output of running one of the commands listed above will output a command for you to run with all environment variables and options configured for you.")]),t._v(" "),s("p",[s("strong",[t._v("Example output for an Ubuntu user:")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("PM2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" You have to run this "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("command")]),t._v(" as root. Execute the following command:\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("su")]),t._v(' -c "env '),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("PATH")])]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$PATH")]),t._v(":/home/user/.nvm/versions/node/v8.9/bin pm2 startup ubuntu -u user --hp /home/user\n")])])]),s("p",[t._v("After running that command, you can continue to the next step.")]),t._v(" "),s("h3",{attrs:{id:"saving-the-current-process-list"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#saving-the-current-process-list"}},[t._v("#")]),t._v(" Saving the current process list")]),t._v(" "),s("p",[t._v("To save the current process list so it will automatically get started after a restart, run the following command:")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("pm2 save\n")])])]),s("p",[t._v("To disable this, you can run the following command:")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("pm2 unstartup\n")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);